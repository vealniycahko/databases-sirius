Прежде чем принять решение о добавлении индекса, нужно проверить, действительно ли он будет использоваться под составляемые запросы. Рассмотрим такой пример:
```sql
drop table if exists users cascade;
create table users
(
    name          text,
    age           int,
    register_date date
);

drop index if exists age_register_date;
create index age_register_date on users using btree (age, register_date);

insert into users(name, age, register_date)
select md5(random()::text), (random() * 70 + 10), date '2022-01-01' + (random() * 100)::int
from generate_series(1, 500);

explain analyse
select *
from users
where age > 20
  and register_date > '2022-03-15';
```

Видим следующий вывод:
`->  Bitmap Index Scan on age_register_date  (cost=0.00..12.28 rows=133 width=0) (actual time=0.023..0.023 rows=124 loops=1)`

Что говорит о том, что индекс действительно используется.


Рассмотрим точно такой же пример, только теперь количество записей в таблице у нас будет равняться 1000:
```sql
drop table if exists users cascade;
create table users
(
    name          text,
    age           int,
    register_date date
);

drop index if exists age_register_date;
create index age_register_date on users using btree (age, register_date);

insert into users(name, age, register_date)
select md5(random()::text), (random() * 70 + 10), date '2022-01-01' + (random() * 100)::int
from generate_series(1, 1000);

explain analyse
select *
from users
where age > 20
  and register_date > '2022-03-15';
```

Видим сообщение о том, что в данном случае использовался линейный поиск:

`Seq Scan on users  (cost=0.00..28.00 rows=133 width=40) (actual time=0.007..0.133 rows=217 loops=1)`

Анализатор запросов постгреса в некоторых случаях может игнорировать наличие индекса, если посчитает, что линейный поиск будет быстрее.
Например в случае, если количество строк в результате составляет большой процент от всех строк в таблице или если всего строк в таблице небольшое количество.
